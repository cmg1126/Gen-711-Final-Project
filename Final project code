Conda activate genomics

cp /tmp/gen711_project_data/fastp.sh Gen-711-Final-Project/fastp.sh
# copies fastp.sh into final project directory (shell script)

chmod +x Gen-711-Final-Project/fastp.sh

Gen-711-Final-Project/fastp.sh 150 /tmp/gen711_project_data/cyano/fastqs  trimmed_fastq
# runs the shell script with 150 poly g length and redirecting the data to trimmed_fastq

conda activate qiime2-2022.8

qiime tools import \
--type SampleData[PairedEndSequencesWithQuality] \
--input-format CasavaOneEightSingleLanePerSampleDirFmt \
--input-path /home/users/cmg1126/trimmed_fastq \
--output-path output/qiime_file.qza
    

qiime cutadapt trim-paired \
    --i-demultiplexed-sequences output/qiime_file.qza \
    --p-cores 4 \
    --p-front-f GTGYCAGCMGCCGCGGTAA \
    --p-front-r CCGYCAATTYMTTTRAGTTT \
    --p-discard-untrimmed \
    --p-match-adapter-wildcards \
    --verbose \
    --o-trimmed-sequences output/qiime_trimmed.qza

qiime demux summarize \
--i-data output/qiime_trimmed.qza \
--o-visualization  output/qiime_visualization.qzv

Denoising

qiime dada2 denoise-paired \
    --i-demultiplexed-seqs output/qiime_trimmed.qza  \
    --p-trunc-len-f 0 \
    --p-trunc-len-r 0 \
    --p-trim-left-f 0 \
    --p-trim-left-r 0 \
    --p-n-threads 4 \
    --o-denoising-stats output/denoising-stats.qza \
    --o-table output/feature_table.qza \
    --o-representative-sequences output/rep-seqs.qza

qiime metadata tabulate \
    --m-input-file denoising/denoising-stats.qza \
    --o-visualization denoising/denoising-stats.qzv

qiime feature-table tabulate-seqs \
        --i-data denoising/rep-seqs.qza \
        --o-visualization denoising/rep-seqs.qzv

Taxonomy assignment 

qiime feature-classifier classify-consensus-vsearch \
  --i-query output/rep-seqs.qza \
  --i-reference-reads <refreads> \
  --i-reference-taxonomy  <reftax> \
  --p-maxaccepts 10 \
  --p-query-cov 0.80 \
  --p-perc-identity 0.9 \
  --p-threads 36 \
  --o-classification output/taxonomy.qza


qiime taxa barplot \
     --i-table output/feature_table-1.qza \
     --i-taxonomy output/taxonomy.qza \
     --o-visualization output/my-barplot.qzv





